<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>cContentEnricher</title><meta name="generator" content="DocBook XSL-NS Stylesheets V1.75.2"><link rel="home" href="bk-tos-esb-mediationcomponents-rg-en..html" title="Talend Open Studio"><link rel="up" href="ch-transformation.html" title="Chapter&nbsp;7.&nbsp;Transformation components"><link rel="prev" href="ch-transformation.html" title="Chapter&nbsp;7.&nbsp;Transformation components"><link rel="next" href="cConvertBodyTo.html" title="cConvertBodyTo"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">cContentEnricher</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="ch-transformation.html">Prev</a>&nbsp;</td><th width="60%" align="center">Chapter&nbsp;7.&nbsp;Transformation components</th><td width="20%" align="right">&nbsp;<a accesskey="n" href="cConvertBodyTo.html">Next</a></td></tr></table><hr></div><div lang="EN" class="section" title="cContentEnricher"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="cContentEnricher"></a>cContentEnricher</h2></div></div></div><div class="mediaobject"><img src="../images/cContentEnricher_icon32.png"></div><div class="section" title="cContentEnricher properties"><div class="titlepage"><div><div><h3 class="title"><a name="d2670e19370"></a>cContentEnricher properties</h3></div></div></div><div class="informaltable"><table border="1"><colgroup><col><col><col></colgroup><tbody><tr><td valign="top">
							<p>
								<span class="emphasis"><strong>Component Family</strong></span>
							</p>
						</td><td colspan="2" valign="top">
							<p>Transformation</p>
						</td></tr><tr><td valign="top">
							<p>
								<span class="emphasis"><strong>Function</strong></span>
							</p>
						</td><td colspan="2" valign="top">
							<p>
								<span class="emphasis"><strong>cContentEnricher</strong></span> is designed to use
								a consumer or producer to obtain additional data, respectively
								intended for event messaging and request/reply messaging.</p>
						</td></tr><tr><td valign="top">
							<p>
								<span class="emphasis"><strong>Purpose</strong></span>
							</p>
						</td><td colspan="2" valign="top">
							<p>
								<span class="emphasis"><strong>cContentEnricher</strong></span> allows you to use
								a consumer or producer to obtain additional data, respectively
								intended for event message messaging and request/reply
								messaging.</p>
						</td></tr><tr><td valign="top">
							<p>
								<span class="emphasis"><strong>Basic settings</strong></span>
							</p>
						</td><td valign="top">
							<p>
								<span class="emphasis"><em>Resource URI</em></span>
							</p>
						</td><td valign="top">
							<p>This refers to the destination to which a message will be
								delivered if <span class="emphasis"><strong>using a producer</strong></span> is
								selected; it refers to the source from which a message will be
								obtained if <span class="emphasis"><strong>using a consumer</strong></span> is
								selected.</p>
						</td></tr><tr><td valign="top">
							<p> </p>
						</td><td valign="top">
							<p>
								<span class="emphasis"><em>Using a producer</em></span>
							</p>
						</td><td valign="top">
							<p>Select this check box to use a producer to provide additional
								data, i.e. sending a message to the defined URI.</p>
						</td></tr><tr><td valign="top">
							<p> </p>
						</td><td valign="top">
							<p>
								<span class="emphasis"><em>Using a consumer</em></span>
							</p>
						</td><td valign="top">
							<p>Select this check box to use a consumer to obtain additional data,
								i.e. requesting a message from the defined URI.</p>
						</td></tr><tr><td valign="top">
							<p> </p>
						</td><td valign="top">
							<p>
								<span class="emphasis"><em>Use Aggregation Strategy</em></span>
							</p>
						</td><td valign="top">
							<p>Select this check box to define the aggregation strategy for
								assembling the basic message and the additional data.</p>
						</td></tr><tr><td valign="top">
							<p> </p>
						</td><td valign="top">
							<p>
								<span class="emphasis"><em>Specify timeout</em></span>
							</p>
						</td><td valign="top">
							<p>This area appears when <span class="emphasis"><em>Using a
									consumer</em></span> is selected. The timeout options are as
								follows:</p>
							<p><span class="emphasis"><strong>Wait until a message arrive</strong></span>: the
								component keeps waiting for a message.</p>
							<p><span class="emphasis"><strong>Immediately polls the message</strong></span>:
								the component immediately polls from the defined URI.</p>
							<p><span class="emphasis"><strong>Waiting at most until the timeout
									triggers</strong></span>: select this check box to type in a timeout
								value in Millis. The component waits for the message only within the
								defined time period.</p>
						</td></tr><tr><td valign="top">
							<p>
								<span class="emphasis"><strong>Usage</strong></span>
							</p>
						</td><td colspan="2" valign="top">
							<p>
								<span class="emphasis"><strong>cContentEnricher</strong></span> allows you to use
								a consumer or producer to obtain additional data, respectively
								intended for event message messaging and request/reply
								messaging.</p>
						</td></tr><tr><td valign="top">
							<p>
								<span class="emphasis"><strong>Limitation</strong></span>
							</p>
						</td><td colspan="2">
							<p>&nbsp;n/a</p>
						</td></tr></tbody></table></div></div><div class="section" title="Scenario: Receiving messages from a list of URLs"><div class="titlepage"><div><div><h3 class="title"><a name="d2670e19580"></a>Scenario: Receiving messages from a list of URLs</h3></div></div></div><p>In this scenario, we will use the Camel component HTTP4 and the <span class="emphasis"><strong>cContentEnricher</strong></span> component to retrieve messages from a list of URLs. To
			do this, we need to build two sub-routes, one to read a file with a list of URLs and
			send the messages to the local file system, the other to retrieve the messages on these
			URLs.</p><p>In this use case, we will take a list of URLs on the local Tomcat server as the
			example. So we need to start Apache Tomcat before executing the Route.</p><p>A TXT file <code class="code">URLlist</code> is used to provide the list of URLs, as shown
			below.</p><pre class="programlisting">docs/introduction.html
docs/setup.html</pre><div class="mediaobject"><img src="../images/use_case-ccontentenricher1.png"></div><div class="section" title="Dropping and linking the components"><div class="titlepage"><div><div><h4 class="title"><a name="d2670e19600"></a>Dropping and linking the components</h4></div></div></div><div class="procedure"><ol class="procedure" type="1"><li class="step" title="Step 1"><p>From the <span class="emphasis"><strong>Palette</strong></span>, drag and drop a
							<span class="emphasis"><strong>cSplitter</strong></span>, a <span class="emphasis"><strong>cJavaDSLProcessor</strong></span>, a <span class="emphasis"><strong>cContentEnricher</strong></span>, two <span class="emphasis"><strong>cFile</strong></span>, two <span class="emphasis"><strong>cMessagingEndpoint</strong></span>,
						and three <span class="emphasis"><strong>cSetHeader</strong></span> components onto the
						design workspace.</p></li><li class="step" title="Step 2"><p>Label the components properly for better identification of their roles and
						link them using the <span class="emphasis"><strong>Row</strong></span> &gt; <span class="emphasis"><strong>Route</strong></span> connection as shown above.</p></li></ol></div></div><div class="section" title="Configuring the components"><div class="titlepage"><div><div><h4 class="title"><a name="d2670e19637"></a>Configuring the components</h4></div></div></div><div class="procedure" title="Procedure&nbsp;7.1.&nbsp;Configuring the first sub-route"><a name="d2670e19640"></a><p class="title"><b>Procedure&nbsp;7.1.&nbsp;Configuring the first sub-route</b></p><ol class="procedure" type="1"><li class="step" title="Step 1"><p>Double-click the <span class="emphasis"><strong>URLlist</strong></span> component to
						display its <span class="emphasis"><strong>Basic settings</strong></span> view in the
							<span class="emphasis"><strong>Component</strong></span> tab.</p><div class="mediaobject"><img src="../images/use_case-ccontentenricher2.png"></div></li><li class="step" title="Step 2"><p>In the <span class="emphasis"><strong>Path</strong></span> field, browse to the file
						path where the URL list file is saved.</p><p>In the <span class="emphasis"><strong>FileName</strong></span> field, enter the filename
							<span class="emphasis"><em>URLlist.txt</em></span>.</p></li><li class="step" title="Step 3"><p>Double-click the <span class="emphasis"><strong>cSplitter</strong></span> component to
						display its <span class="emphasis"><strong>Basic settings</strong></span> view in the
							<span class="emphasis"><strong>Component</strong></span> tab.</p><div class="mediaobject"><img src="../images/use_case-ccontentenricher3.png"></div></li><li class="step" title="Step 4"><p>In the <span class="emphasis"><strong>Expression</strong></span> field, enter the code
							<code class="code">body(String.class).tokenize("\r\n")</code> to split the message in
						each row into sub-messages.</p><div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>Note that this piece of code is for Windows only. For Unix, change it
							to <code class="code">body(String.class).tokenize("\n")</code>, and for Mac,
								<code class="code">body(String.class).tokenize("\r")</code>.</p></div></li><li class="step" title="Step 5"><p>Double-click the <span class="emphasis"><strong>cJavaDSLProcessor</strong></span>
						component to display its <span class="emphasis"><strong>Basic settings</strong></span>
						view in the <span class="emphasis"><strong>Component</strong></span> tab.</p><div class="mediaobject"><img src="../images/use_case-ccontentenricher4.png"></div></li><li class="step" title="Step 6"><p>In the <span class="emphasis"><strong>Code</strong></span> area, enter the code
							<code class="code">.log("splitterOutput: ${body}")</code> to get the split message
						body.</p></li><li class="step" title="Step 7"><p>Double-click the <span class="emphasis"><strong>cContentEnricher</strong></span>
						component display its <span class="emphasis"><strong>Basic settings</strong></span> view
						in the <span class="emphasis"><strong>Component</strong></span> tab.</p><div class="mediaobject"><img src="../images/use_case-ccontentenricher5.png"></div></li><li class="step" title="Step 8"><p>Select <span class="emphasis"><strong>using a producer</strong></span> to use a producer
						to provide additional data and send the message to a defined URI.</p><p>In the <span class="emphasis"><strong>Resource URI</strong></span> field, enter
							<code class="code">"direct:fetchURL"</code> where the message will be delivered.
					</p></li><li class="step" title="Step 9"><p>Double-click the <span class="emphasis"><strong>setFileName</strong></span> component to
						display its <span class="emphasis"><strong>Basic settings</strong></span> view in the
							<span class="emphasis"><strong>Component</strong></span> tab.</p><div class="mediaobject"><img src="../images/use_case-ccontentenricher6.png"></div></li><li class="step" title="Step 10"><p>Click <span class="emphasis"><strong>[+]</strong></span> to add a row to the <span class="emphasis"><strong>Headers</strong></span> table.</p><p>In the <span class="emphasis"><strong>Name</strong></span> field, enter
							<code class="code">org.apache.camel.Exchange.FILE_NAME</code> to define the file name
						for each incoming message.</p><p>Select <span class="emphasis"><strong>Simple</strong></span> in the <span class="emphasis"><strong>Language</strong></span> list.</p><p>In the <span class="emphasis"><strong>Value</strong></span> field, enter
							<code class="code">"${header.CamelHttpPath}"</code> to get the URI's path of the
						incoming message.</p></li><li class="step" title="Step 11"><p>Double-click the <span class="emphasis"><strong>retrievedFiles</strong></span> component
						to display its <span class="emphasis"><strong>Basic settings</strong></span> view in the
							<span class="emphasis"><strong>Component</strong></span> tab.</p><div class="mediaobject"><img src="../images/use_case-ccontentenricher7.png"></div></li><li class="step" title="Step 12"><p>In the <span class="emphasis"><strong>Path</strong></span> field, browse to the
						destination file path where you want the messages to be saved.</p></li></ol></div><div class="procedure" title="Procedure&nbsp;7.2.&nbsp;Configuring the second sub-route"><a name="d2670e19827"></a><p class="title"><b>Procedure&nbsp;7.2.&nbsp;Configuring the second sub-route</b></p><ol class="procedure" type="1"><li class="step" title="Step 1"><p>Double-click the <span class="emphasis"><strong>fetchURL</strong></span> component to
						display its <span class="emphasis"><strong>Basic settings</strong></span> view in the
							<span class="emphasis"><strong>Component</strong></span> tab.</p><div class="mediaobject"><img src="../images/use_case-ccontentenricher8.png"></div></li><li class="step" title="Step 2"><p>In the <span class="emphasis"><strong>URI</strong></span> field, enter <span class="emphasis"><em>"direct:fetchURL"</em></span> that is defined in the
							<span class="emphasis"><strong>cContentEnricher</strong></span> component.</p></li><li class="step" title="Step 3"><p>Double-click the <span class="emphasis"><strong>setURI</strong></span> component to
						display its <span class="emphasis"><strong>Basic settings</strong></span> view in the
							<span class="emphasis"><strong>Component</strong></span> tab.</p><div class="mediaobject"><img src="../images/use_case-ccontentenricher9.png"></div></li><li class="step" title="Step 4"><p>Click <span class="emphasis"><strong>[+]</strong></span> to add a row to the <span class="emphasis"><strong>Headers</strong></span> table.</p><p>In the <span class="emphasis"><strong>Name</strong></span> field, enter
							<code class="code">org.apache.camel.Exchange.HTTP_URI</code> to define the HTTP URI
						of each message.</p><p>Select <span class="emphasis"><strong>Simple</strong></span> in the <span class="emphasis"><strong>Language</strong></span> list.</p><p>In the <span class="emphasis"><strong>Value</strong></span> field, enter
							<code class="code">"http://localhost:8080"</code> of the local Tomcat server.</p></li><li class="step" title="Step 5"><p>Double-click the <span class="emphasis"><strong>setPATH</strong></span> component to
						display its <span class="emphasis"><strong>Basic settings</strong></span> view in the
							<span class="emphasis"><strong>Component</strong></span> tab.</p><div class="mediaobject"><img src="../images/use_case-ccontentenricher10.png"></div></li><li class="step" title="Step 6"><p>Click <span class="emphasis"><strong>[+]</strong></span> to add a row to the <span class="emphasis"><strong>Headers</strong></span> table.</p><p>In the <span class="emphasis"><strong>Name</strong></span> field, enter
							<code class="code">org.apache.camel.Exchange.HTTP_PATH</code> to define the HTTP path
						of each message.</p><p>Select <span class="emphasis"><strong>Simple</strong></span> in the <span class="emphasis"><strong>Language</strong></span> list.</p><p>In the <span class="emphasis"><strong>Value</strong></span> field, enter
							<code class="code">"${body}"</code> that is split from the original message.</p></li><li class="step" title="Step 7"><p>Double-click the <span class="emphasis"><strong>http4Endpoint</strong></span> component
						to display its <span class="emphasis"><strong>Basic settings</strong></span> view in the
							<span class="emphasis"><strong>Component</strong></span> tab.</p><div class="mediaobject"><img src="../images/use_case-ccontentenricher11.png"></div></li><li class="step" title="Step 8"><p>In the <span class="emphasis"><strong>URI</strong></span> field, enter <span class="emphasis"><em>"http4:localhost:8080"</em></span> to consuming HTTP
						resources on the local Tomcat server.</p></li><li class="step" title="Step 9"><p>Click the <span class="emphasis"><strong>Advanced settings</strong></span> view. Click <span class="inlinemediaobject"><img src="../images/plus_button.png"></span> at the bottom of the <span class="emphasis"><strong>Dependencies</strong></span> list to add a row and select <code class="code">http4</code>
						from the drop-down list. For more information about HTTP4, see the site
							<a class="link" href="http://camel.apache.org/http4.html" target="_top">http://camel.apache.org/http4.html</a>.</p><div class="mediaobject"><img src="../images/use_case-ccontentenricher13.png"></div></li></ol></div><p>Press <span class="emphasis"><strong>Ctrl+S</strong></span> to save your Route.</p></div><div class="section" title="Viewing code and executing the Route"><div class="titlepage"><div><div><h4 class="title"><a name="d2670e20004"></a>Viewing code and executing the Route</h4></div></div></div><div class="procedure"><ol class="procedure" type="1"><li class="step" title="Step 1"><p>Click the <span class="emphasis"><strong>Code</strong></span> tab at the bottom of the
						design workspace to have a look at the generated code. </p><div class="mediaobject"><img src="../images/use_case-ccontentenricher12.png"></div><p>As shown above, a message route is built from the <code class="code">URLlist</code> to
						the <code class="code">retrievedFiles</code> via the <code class="code">.split</code>,
							<code class="code">.log</code>, <code class="code">.enrich</code>, and <code class="code">.setHeader</code>.
						The other message route is built from <code class="code">fetchURL</code> to
							<code class="code">http4Endpoint</code> via two <code class="code">.setHeader</code>. </p></li><li class="step" title="Step 2"><p>Press <span class="emphasis"><strong>F6</strong></span> to execute the Route. </p><p>RESULT: The split message is printed on the <span class="emphasis"><strong>Run</strong></span>
						console.</p><div class="mediaobject"><img src="../images/use_case-ccontentenricher14.png"></div><p>The messages from the list of URLs are saved in defined directory of the
						local file system.</p><div class="mediaobject"><img src="../images/use_case-ccontentenricher15.png"></div></li></ol></div></div></div><div class="section" title="Related scenario"><div class="titlepage"><div><div><h3 class="title"><a name="d2670e20065"></a>Related scenario</h3></div></div></div><p>For a related scenario, see: </p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p><span class="emphasis"><strong>cMulticast</strong></span>: <a class="xref" href="cMulticast.html#cmulticast-scenario-multicasting_message_to_endpoints" title="Scenario: Multicasting a message to two endpoints and using it to enrich the contents received by the third endpoint">the section called &#8220;Scenario: Multicasting a message to two endpoints and using it to enrich the contents
			received by the third endpoint&#8221;</a>.</p></li></ul></div></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="ch-transformation.html">Prev</a>&nbsp;</td><td width="20%" align="center"><a accesskey="u" href="ch-transformation.html">Up</a></td><td width="40%" align="right">&nbsp;<a accesskey="n" href="cConvertBodyTo.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">Chapter&nbsp;7.&nbsp;Transformation components&nbsp;</td><td width="20%" align="center"><a accesskey="h" href="bk-tos-esb-mediationcomponents-rg-en..html">Home</a></td><td width="40%" align="right" valign="top">&nbsp;cConvertBodyTo</td></tr></table></div></body></html>